<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tech.v3.dataset.reductions documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tech.ml.dataset</span> <span class="project-version">5.00-alpha-19</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="columns-readers-and-datatypes.html"><div class="inner"><span>Columns, Readers, and Datatypes</span></div></a></li><li class="depth-1 "><a href="nippy-serialization-rocks.html"><div class="inner"><span>Nippy Rocks!</span></div></a></li><li class="depth-1 "><a href="quick-reference.html"><div class="inner"><span>Quick Reference - Core API</span></div></a></li><li class="depth-1 "><a href="walkthrough.html"><div class="inner"><span>tech.ml.dataset Walkthrough</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tech</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>v3</span></div></div></li><li class="depth-3"><a href="tech.v3.dataset.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dataset</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.categorical.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>categorical</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.column-filters.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>column-filters</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></div></li><li class="depth-5 branch"><a href="tech.v3.dataset.io.datetime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datetime</span></div></a></li><li class="depth-5 branch"><a href="tech.v3.dataset.io.string-row-parser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>string-row-parser</span></div></a></li><li class="depth-5"><a href="tech.v3.dataset.io.univocity.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>univocity</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.join.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>join</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.math.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.modelling.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>modelling</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.dataset.print.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>print</span></div></a></li><li class="depth-4 branch current"><a href="tech.v3.dataset.reductions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reductions</span></div></a></li><li class="depth-4"><a href="tech.v3.dataset.tensor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tensor</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -393px;"><span class="top" style="height: 402px;"></span><span class="bottom"></span></span><span>libs</span></div></div></li><li class="depth-4 branch"><a href="tech.v3.libs.arrow.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>arrow</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.libs.fastexcel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastexcel</span></div></a></li><li class="depth-4 branch"><a href="tech.v3.libs.parquet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parquet</span></div></a></li><li class="depth-4"><a href="tech.v3.libs.poi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>poi</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-aggregate-reducer"><div class="inner"><span>aggregate-reducer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-bitmap-consumer"><div class="inner"><span>bitmap-consumer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-double-reducer"><div class="inner"><span>double-reducer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-group-by-column-aggregate"><div class="inner"><span>group-by-column-aggregate</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-long-reducer"><div class="inner"><span>long-reducer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-min-max-sum-consumer"><div class="inner"><span>min-max-sum-consumer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-object-reducer"><div class="inner"><span>object-reducer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-set-consumer"><div class="inner"><span>set-consumer</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-stream-.3Earray"><div class="inner"><span>stream-&gt;array</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-stream-.3Evec"><div class="inner"><span>stream-&gt;vec</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.reductions.html#var-sum-consumer"><div class="inner"><span>sum-consumer</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tech.v3.dataset.reductions</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-aggregate-reducer"><h3>aggregate-reducer</h3><div class="usage"><code>(aggregate-reducer reducer-map)</code></div><div class="doc"><div class="markdown"><p>Create a reducer that aggregates to several other reducers. Reducers are provided in a map of reducer-name-&gt;reducer and the result is a map of reducer-name -&gt; finalized reducer value.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L228">view source</a></div></div><div class="public anchor" id="var-bitmap-consumer"><h3>bitmap-consumer</h3><div class="usage"><code>(bitmap-consumer)</code></div><div class="doc"><div class="markdown"><p>Perform a consumer which aggregates to a RoaringBitmap.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L204">view source</a></div></div><div class="public anchor" id="var-double-reducer"><h3>double-reducer</h3><div class="usage"><code>(double-reducer colname-seq staged-double-consumer-constructor-fn)</code></div><div class="doc"><div class="markdown"><p>Create an indexed reduction that uses double readers expects DoubleConsumers. constructor-fn will be used to create context-specific double consumers.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L158">view source</a></div></div><div class="public anchor" id="var-group-by-column-aggregate"><h3>group-by-column-aggregate</h3><div class="usage"><code>(group-by-column-aggregate column-name reducer {:keys [finalize-type map-initial-capacity], :or {map-initial-capacity 100000, finalize-type :stream}} ds-seq)</code><code>(group-by-column-aggregate column-name reducer ds-seq)</code></div><div class="doc"><div class="markdown"><p>Perform a group by over a sequence of datasets where the reducer is handed each index and the context is stored in a map. The reduction in this case is unordered so your indexes will arrive out of order. The index-reductions’s prepare-batch method will be called once with each dataset before iterating over that dataset’s items.</p>
<p>There are three possible return value types for this function. Called with no options tuples of key to finalized value will be returned via a parallel java stream. There is an option to pass in your own consumer so you your function will get called for every k,v tuple and finally there is an option to get the unfinalized ConcurrentHashMap.</p>
<p>Options:</p>
<ul>
  <li>
    <p><code>:finalize-type</code> - One of three options, defaults to <code>:stream</code>.</p>
    <ul>
      <li><code>:stream</code> - The finalized results will be returned in the form of k,v tuples in a <code>java.util.stream.Stream</code>.</li>
      <li>An instant of <code>clojure.lang.IFn</code> - This function, which must accept 2 arguments,  will be called on each k,v pair and no value will be returned.</li>
      <li><code>:skip</code> - The entire java.util.ConcurrentHashMap will be returned with the value  in an unfinalized state. It will be up to the caller to call the reducer’s  finalize method on all the values.</li>
    </ul>
  </li>
  <li>
  <p><code>:map-initial-capacity</code> - initial capacity – this can have a big effect on  overall algorithm speed according to the  <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html">documentation</a>.</p></li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L26">view source</a></div></div><div class="public anchor" id="var-long-reducer"><h3>long-reducer</h3><div class="usage"><code>(long-reducer colname-seq staged-long-consumer-constructor-fn)</code></div><div class="doc"><div class="markdown"><p>Create an indexed reduction that uses long readers expects LongConsumers. constructor-fn will be used to create context-specific long consumers.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L165">view source</a></div></div><div class="public anchor" id="var-min-max-sum-consumer"><h3>min-max-sum-consumer</h3><div class="usage"><code>(min-max-sum-consumer)</code></div><div class="doc"><div class="markdown"><p>Create a double consumer which will perform min, max, and sum the values.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L185">view source</a></div></div><div class="public anchor" id="var-object-reducer"><h3>object-reducer</h3><div class="usage"><code>(object-reducer colname-seq staged-consumer-constructor-fn)</code></div><div class="doc"><div class="markdown"><p>Create an indexed reduction that uses object readers expects ObjectConsumers. constructor-fn will be used to create context-specific object consumers.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L172">view source</a></div></div><div class="public anchor" id="var-set-consumer"><h3>set-consumer</h3><div class="usage"><code>(set-consumer)</code></div><div class="doc"><div class="markdown"><p>Create a consumer which aggregates to a HashSet.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L222">view source</a></div></div><div class="public anchor" id="var-stream-.3Earray"><h3>stream-&gt;array</h3><div class="usage"><code>(stream-&gt;array data)</code></div><div class="doc"><div class="markdown"><p>Convert a java stream into an object array.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L87">view source</a></div></div><div class="public anchor" id="var-stream-.3Evec"><h3>stream-&gt;vec</h3><div class="usage"><code>(stream-&gt;vec data)</code></div><div class="doc"><div class="markdown"><p>Convert a java stream into a persistent vector.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L93">view source</a></div></div><div class="public anchor" id="var-sum-consumer"><h3>sum-consumer</h3><div class="usage"><code>(sum-consumer)</code></div><div class="doc"><div class="markdown"><p>Create a double consumer which will sum the values.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tech/v3/dataset/reductions.clj#L179">view source</a></div></div></div></body></html>